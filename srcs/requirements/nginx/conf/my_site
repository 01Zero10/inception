
#server {
#	listen 80;
#	listen [::]:80;
#
#	server_name my_site;
#
#	return 301 https://$host$request_uri;
#}

server {
	listen 443 ssl ;
	listen [::]:443 ssl ;

	ssl on;
	ssl_certificate /etc/nginx/ssl/my_site.crt;
	ssl_certificate_key /etc/nginx/ssl/my_site.key;
	ssl_protocols TLSv1.2;

	server_name dbalducc.42.fr;

	root /var/www/my_site;
	index index.php index.html index.htm index.nginx-debian.html;

	location /{
		autoindex off;
		try_files $uri $uri/ =404;
	}

	location ~ \.php$ {
		fastcgi_split_path_info ^(.+\.php)(/.+)$;
		fastcgi_pass wordpress:9000;
		fastcgi_index index.php;
		include fastcgi_params;
		fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
		fastcgi_param SCRIPT_NAME $fastcgi_script_name;
	}
}
